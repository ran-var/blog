<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    
    <meta name="description" content="work in progress ü§´Honestly the only reason I got into this rabbit hole is having an old laptop lying around and wondered how far I can stretch the line without bricking it entirely. In particular to">
<meta property="og:type" content="article">
<meta property="og:title" content="$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware">
<meta property="og:url" content="https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/">
<meta property="og:site_name" content="Ran Varshaver">
<meta property="og:description" content="work in progress ü§´Honestly the only reason I got into this rabbit hole is having an old laptop lying around and wondered how far I can stretch the line without bricking it entirely. In particular to">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://ran-var.github.io/blog/images/spichip.jpg">
<meta property="article:published_time" content="1111-11-11T00:00:00.000Z">
<meta property="article:modified_time" content="2025-10-20T11:33:26.498Z">
<meta property="article:author" content="Ran Varshaver">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ran-var.github.io/blog/images/spichip.jpg">
    
    
    
    
      
        <link rel="shortcut icon" href="/images/favicon.ico">
      
      
        <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
      
      
        <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
      
    

    <title>$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware</title>

    <!-- async scripts -->
    
    

    
<link rel="stylesheet" href="/blog/css/style.css">


    

    
<meta name="generator" content="Hexo 8.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/blog/2025/09/16/xml-overflow/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&text=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&is_video=false&description=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware&body=Check out this article: https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&name=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&t=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#work-in-progress-%F0%9F%A4%AB"><span class="toc-number">1.</span> <span class="toc-text">work in progress ü§´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BitLocker-101-Keys-TPMs-and-Cryptography"><span class="toc-number">2.</span> <span class="toc-text">BitLocker 101: Keys, TPMs, and Cryptography</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <a href="/blog/" class="back-link">‚Üê Back</a>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        $5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Ran Varshaver</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="1111-11-11T00:00:00.000Z" class="dt-published" itemprop="datePublished">11-11-1111</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="work-in-progress-ü§´"><a href="#work-in-progress-ü§´" class="headerlink" title="work in progress ü§´"></a>work in progress ü§´</h2><p>Honestly the only reason I got into this rabbit hole is having an old laptop lying around and wondered how far I can stretch the line without bricking it entirely. In particular to see how disk encryption actually works under the hood and trying to break it by clipping some cheap hardware hacking tools from AliExpress like a CH341A.</p>
<p>Special thanks to <a target="_blank" rel="noopener" href="https://x.com/xenokovah">Xeno Kovah</a> and <a target="_blank" rel="noopener" href="https://p.ost2.fyi/">OpenSecurityTraining2</a> for sparking my curiosity and providing some incredible quality material.</p>
<h2 id="BitLocker-101-Keys-TPMs-and-Cryptography"><a href="#BitLocker-101-Keys-TPMs-and-Cryptography" class="headerlink" title="BitLocker 101: Keys, TPMs, and Cryptography"></a>BitLocker 101: Keys, TPMs, and Cryptography</h2><p>Lets walk through how BitLocker is supposed to work, because the more you understand the elegant design, the more the real world flaws start to make sense.<br>BitLocker represents Microsoft‚Äôs attempt to solve a genuinely hard problem: how do you automatically decrypt a hard drive when an authorized user boots their computer, but keep it locked when an unauthorized person tries to access the data?</p>
<p>The solution relies on a ‚Äútrusted boot‚Äù process. Think of it as a chain of cryptographic measurements that starts with your computer‚Äôs firmware and continues through each piece of software that loads during startup. Each component hashes the next, creating a unique fingerprint of your system‚Äôs exact boot state.</p>
<p>It does so by using what‚Äôs called a Trusted Platform Module(TPM) chip, which only hands over the keys once the measured state matches the same state as when Bitlocker was first configured on the machine. If anything significant has changed in the boot process the TPM chip will not transfer the keys and may require a Bitlocker recovery process.</p>
<p>This measurement process creates what‚Äôs called a ‚Äúroot of trust‚Äù but like any chain, it‚Äôs only as strong as its weakest link. The TPM measures each component, but it has to trust that the measurements it receives are valid, and this is where the elegance starts to show cracks.</p>
<p>When your computer boots, the UEFI&#x2F;BIOS firmware is the first code to run, responsible for measuring itself and the next component in the chain. But here‚Äôs the catch: the UEFI firmware lives in SPI flash memory which is a small chip that‚Äôs often easily accessible on the motherboard and wasn‚Äôt designed with sophisticated tamper protection in mind.</p>
<p><em>Exercise! Try looking at an old motherboard or any PCB you have lying around and find a small 8-legged chip and do a short google search on the text that‚Äôs written on it, most chip vendors provide an open source datasheet</em><br><img src="/blog/images/spichip.jpg" alt="spi flash chip"></p>
<p>This is where a cheap flash programmer comes into play, it can directly read and write to SPI flash chips containing the sealed BitLocker keys or parameters used to derive them. The irony is that BitLocker‚Äôs strength its tight integration with the hardware boot process also creates its most exploitable weakness. Every piece of the trusted boot chain becomes a potential attack surface for someone with physical access.</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#work-in-progress-%F0%9F%A4%AB"><span class="toc-number">1.</span> <span class="toc-text">work in progress ü§´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BitLocker-101-Keys-TPMs-and-Cryptography"><span class="toc-number">2.</span> <span class="toc-text">BitLocker 101: Keys, TPMs, and Cryptography</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&text=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&is_video=false&description=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware&body=Check out this article: https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&title=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&name=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://ran-var.github.io/blog/1111/11/11/bitlocker-leak/&t=$5 UEFI Attack: How Attackers Extract BitLocker Keys Through Hardware"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>
  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2025
    Ran Varshaver
  </div>
  <div class="footer-right">
  </div>
</footer>

    </div>
    

 
  <link
    rel="preload"
    href="/blog/lib/font-awesome/css/all.min.css"
    as="style"
    onload="this.onload=null;this.rel='stylesheet'"
  />
  <noscript
    ><link
      rel="stylesheet"
      href="/blog/lib/font-awesome/css/all.min.css"
  /></noscript>


    
  
<script src="/blog/lib/jquery/jquery.min.js"></script>






  
    
<script src="/blog/lib/clipboard/clipboard.min.js"></script>

  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/blog/js/main.js"></script>



</body>
</html>
